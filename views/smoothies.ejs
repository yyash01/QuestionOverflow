<!-- Smoothies is for displaying all Questions -->
<%- include('partials/header'); -%>
<div class="wrapper">
  <button type="button" class="btn-success">
    <a href="/UpdateQuestionList" class="textC">Ask Question</a>
  </button>
  <!-- <div class="search-input">
    <form style="display: flex; flex-direction: row">
      <input type="text" name="search" placeholder="Type to search.." />
      <button class="btop">
        <i class="fas fa-search"></i>
      </button>
    </form>
    <script>
      const form = document.querySelector("form");
      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const search = form.search.value;
        try {
          const res = await fetch("/question/show", {
            method: "POST",
            body: JSON.stringify({ search }),
            headers: { "Content-Type": "application/json" },
          });
          const data = await res.json();
          console.log(data);
        } catch (err) {
          console.log(err);
        }
      });
    </script>
  </div> -->
</div>
<ul class="recipes">
  <% question.forEach(function(q){ %>
  <li class="recipe">
    <img src="/logo4.png" alt="smoothie recipe icon" />
    <h4><%= q.title %></h4>
    <div class="simple">
      <a href="/questions/<%= q._id %>" class="button-two" style="color: white">
        <b>More-Info</b>
      </a>
      <%if(user && q.author.id.equals(user._id)){%>
      <button type="button" onclick="doDelete('<%= q._id %>');">
        <i class="fas fa-trash"></i>
      </button>
      <%}%>
    </div>
  </li>
  <% }); %>
</ul>
<script>
  async function doDelete(questionID) {
    try {
      const res = await fetch("/question/delete", {
        method: "POST",
        body: JSON.stringify({ questionID }),
        headers: { "Content-Type": "application/json" },
      });
      const data = await res.json();
      if (data.msg === "success") {
        location.assign("/smoothies");
      }
    } catch (err) {
      console.log(err);
    }
  }
</script>
<%- include('partials/footer'); -%>
